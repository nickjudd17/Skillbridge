{% extends "base.html" %}
{% block content %}
  <h2>Available Projects</h2>
  <div class="list-group">
    {% for project in projects %}
      <div class="list-group-item">
        <h5>{{ project.title }}</h5>
        <p>{{ project.description }}</p>

        {% if current_user.is_authenticated %}
          <!-- Student actions -->
          {% if current_user.role == 'student' %}
            <a href="{{ url_for('applications.apply', project_id=project.id) }}" class="btn btn-sm btn-success">Apply</a>
          {% endif %}

          <!-- Business actions (only for the owner of the project) -->
          {% if current_user.role == 'business' and project.posted_by == current_user.id %}
            <a href="{{ url_for('applications.manage_applications', project_id=project.id) }}" class="btn btn-sm btn-secondary">Manage Applications</a>
          {% endif %}

          <!-- Reviews -->
          <a href="{{ url_for('reviews.new_review', project_id=project.id) }}" class="btn btn-sm btn-warning">Leave Review</a>
          <a href="{{ url_for('reviews.view_reviews', project_id=project.id) }}" class="btn btn-sm btn-info">View Reviews</a>
        {% endif %}
      </div>
    {% else %}
      <p class="text-muted">No projects posted yet.</p>
    {% endfor %}
  </div>
{% endblock %}